/**
 * Rocket JavaScript Library v0.0.1
 *
 * Copyright 2010, Araneo Ltd. <http://www.araneo.pl>
 * Released under the MIT license.
 *
 * Author: Chris Kowalik <chris@nu7hat.ch>
 */

/**
 * This code is strongly inspired by and based on the Pusher JavaScript Library.
 *
 * Pusher JavaScript Library:
 *
 *   Copyright 2010, New Bamboo <http://new-bamboo.co.uk/>
 *   Released under the MIT licence.
 *   Reference: http://pusherapp.com
 *
 * This library contains also code with the following licences:
 *
 * web_socket.js:
 *
 *   Copyright: Hiroshi Ichikawa <http://gimite.net/en/>
 *   License: New BSD License
 *   Reference: http://dev.w3.org/html5/websockets/
 *   Reference: http://tools.ietf.org/html/draft-hixie-thewebsocketprotocol
 *
 * swfobject.js:
 *
 *   SWFObject v2.2 <http://code.google.com/p/swfobject/>
 *   is released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 *
 * FABridge.js:
 *
 *   Copyright 2006 Adobe Systems Incorporated
 *
 *   Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"),
 *   to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,
 *   and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 *   The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 */


var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var a=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,e=aB.userAgent.toLowerCase(),c=aB.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(e),j=c?/mac/.test(c):/mac/.test(e),g=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,d=!+"\v1",f=[0,0,0],k=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){k=aB.plugins[ab].description;if(k&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;d=false;k=k.replace(/^.*\s+(\S+\s+\S+$)/,"$1");f[0]=parseInt(k.replace(/^(.*)\..*$/,"$1"),10);f[1]=parseInt(k.replace(/^.*\.(.*)\s.*$/,"$1"),10);f[2]=/[a-zA-Z]/.test(k)?parseInt(k.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof af.ActiveXObject!=aq){try{var i=new ActiveXObject(X);if(i){k=i.GetVariable("$version");if(k){d=true;k=k.split(" ")[1].split(",");f=[parseInt(k[0],10),parseInt(k[1],10),parseInt(k[2],10)]}}}catch(b){}}}return{w3:a,pv:f,wk:g,ie:d,win:h,mac:j}}(),aK=function(){if(!ah.w3){return}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP()}});if(af==top){(function(){if(ak){return}try{aL.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}aP()})()}}if(ah.wk){(function(){if(ak){return}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return}aP()})()}aC(aP)}}();function aP(){if(ak){return}try{var b=aL.getElementsByTagName("body")[0].appendChild(ar("span"));b.parentNode.removeChild(b)}catch(a){return}ak=true;var d=Z.length;for(var c=0;c<d;c++){Z[c]()}}function aj(a){if(ak){a()}else{Z[Z.length]=a}}function aC(a){if(typeof af.addEventListener!=aq){af.addEventListener("load",a,false)}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",a,false)}else{if(typeof af.attachEvent!=aq){aM(af,"onload",a)}else{if(typeof af.onload=="function"){var b=af.onload;af.onload=function(){b();a()}}else{af.onload=a}}}}}function aN(){if(aa){Y()}else{am()}}function Y(){var d=aL.getElementsByTagName("body")[0];var b=ar(aD);b.setAttribute("type",aE);var a=d.appendChild(b);if(a){var c=0;(function(){if(typeof a.GetVariable!=aq){var e=a.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");ah.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else{if(c<10){c++;setTimeout(arguments.callee,10);return}}d.removeChild(b);a=null;am()})()}else{am()}}function am(){var g=aG.length;if(g>0){for(var h=0;h<g;h++){var c=aG[h].id;var l=aG[h].callbackFn;var a={success:false,id:c};if(ah.pv[0]>0){var i=aS(c);if(i){if(ao(aG[h].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(c,true);if(l){a.success=true;a.ref=av(c);l(a)}}else{if(aG[h].expressInstall&&au()){var e={};e.data=aG[h].expressInstall;e.width=i.getAttribute("width")||"0";e.height=i.getAttribute("height")||"0";if(i.getAttribute("class")){e.styleclass=i.getAttribute("class")}if(i.getAttribute("align")){e.align=i.getAttribute("align")}var f={};var d=i.getElementsByTagName("param");var k=d.length;for(var j=0;j<k;j++){if(d[j].getAttribute("name").toLowerCase()!="movie"){f[d[j].getAttribute("name")]=d[j].getAttribute("value")}}ae(e,f,c,l)}else{aF(i);if(l){l(a)}}}}}else{ay(c,true);if(l){var b=av(c);if(b&&typeof b.SetVariable!=aq){a.success=true;a.ref=b}l(a)}}}}}function av(b){var d=null;var c=aS(b);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=aq){d=c}else{var a=c.getElementsByTagName(aD)[0];if(a){d=a}}}return d}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)}function ae(f,d,h,e){aU=true;ap=e||null;at={success:false,id:h};var a=aS(h);if(a){if(a.nodeName=="OBJECT"){aJ=aO(a);ad=null}else{aJ=a;ad=h}f.id=ac;if(typeof f.width==aq||(!/%$/.test(f.width)&&parseInt(f.width,10)<310)){f.width="310"}if(typeof f.height==aq||(!/%$/.test(f.height)&&parseInt(f.height,10)<137)){f.height="137"}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var b=ah.ie&&ah.win?"ActiveX":"PlugIn",c="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aL.title;if(typeof d.flashvars!=aq){d.flashvars+="&"+c}else{d.flashvars=c}if(ah.ie&&ah.win&&a.readyState!=4){var g=ar("div");h+="SWFObjectNew";g.setAttribute("id",h);a.parentNode.insertBefore(g,a);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}aA(f,d,h)}}function aF(a){if(ah.ie&&ah.win&&a.readyState!=4){var b=ar("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(aO(a),b);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}else{a.parentNode.replaceChild(aO(a),a)}}function aO(b){var d=ar("div");if(ah.win&&ah.ie){d.innerHTML=b.innerHTML}else{var e=b.getElementsByTagName(aD)[0];if(e){var a=e.childNodes;if(a){var f=a.length;for(var c=0;c<f;c++){if(!(a[c].nodeType==1&&a[c].nodeName=="PARAM")&&!(a[c].nodeType==8)){d.appendChild(a[c].cloneNode(true))}}}}}return d}function aA(e,g,c){var d,a=aS(c);if(ah.wk&&ah.wk<312){return d}if(a){if(typeof e.id==aq){e.id=c}if(ah.ie&&ah.win){var f="";for(var i in e){if(e[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){g.movie=e[i]}else{if(i.toLowerCase()=="styleclass"){f+=' class="'+e[i]+'"'}else{if(i.toLowerCase()!="classid"){f+=" "+i+'="'+e[i]+'"'}}}}}var h="";for(var j in g){if(g[j]!=Object.prototype[j]){h+='<param name="'+j+'" value="'+g[j]+'" />'}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>";ag[ag.length]=e.id;d=aS(e.id)}else{var b=ar(aD);b.setAttribute("type",aE);for(var k in e){if(e[k]!=Object.prototype[k]){if(k.toLowerCase()=="styleclass"){b.setAttribute("class",e[k])}else{if(k.toLowerCase()!="classid"){b.setAttribute(k,e[k])}}}}for(var l in g){if(g[l]!=Object.prototype[l]&&l.toLowerCase()!="movie"){aQ(b,l,g[l])}}a.parentNode.replaceChild(b,a);d=b}}return d}function aQ(b,d,c){var a=ar("param");a.setAttribute("name",d);a.setAttribute("value",c);b.appendChild(a)}function aw(a){var b=aS(a);if(b&&b.nodeName=="OBJECT"){if(ah.ie&&ah.win){b.style.display="none";(function(){if(b.readyState==4){aT(a)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.removeChild(b)}}}function aT(a){var b=aS(a);if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null}}b.parentNode.removeChild(b)}}function aS(a){var c=null;try{c=aL.getElementById(a)}catch(b){}return c}function ar(a){return aL.createElement(a)}function aM(a,c,b){a.attachEvent(c,b);al[al.length]=[a,c,b]}function ao(a){var b=ah.pv,c=a.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false}function az(b,f,a,c){if(ah.ie&&ah.mac){return}var e=aL.getElementsByTagName("head")[0];if(!e){return}var g=(a&&typeof a=="string")?a:"screen";if(c){aH=null;an=null}if(!aH||an!=g){var d=ar("style");d.setAttribute("type","text/css");d.setAttribute("media",g);aH=e.appendChild(d);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]}an=g}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(b,f)}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(b+" {"+f+"}"))}}}function ay(a,c){if(!aI){return}var b=c?"visible":"hidden";if(ak&&aS(a)){aS(a).style.visibility=b}else{az("#"+a,"visibility:"+b)}}function ai(b){var a=/[\\\"<>\.;]/;var c=a.exec(b)!=null;return c&&typeof encodeURIComponent!=aq?encodeURIComponent(b):b}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var a=al.length;for(var b=0;b<a;b++){al[b][0].detachEvent(al[b][1],al[b][2])}var d=ag.length;for(var c=0;c<d;c++){aw(ag[c])}for(var e in ah){ah[e]=null}ah=null;for(var f in swfobject){swfobject[f]=null}swfobject=null})}}();return{registerObject:function(a,e,c,b){if(ah.w3&&a&&e){var d={};d.id=a;d.swfVersion=e;d.expressInstall=c;d.callbackFn=b;aG[aG.length]=d;ay(a,false)}else{if(b){b({success:false,id:a})}}},getObjectById:function(a){if(ah.w3){return av(a)}},embedSWF:function(k,e,h,f,c,a,b,i,g,j){var d={success:false,id:e};if(ah.w3&&!(ah.wk&&ah.wk<312)&&k&&e&&h&&f&&c){ay(e,false);aj(function(){h+="";f+="";var q={};if(g&&typeof g===aD){for(var o in g){q[o]=g[o]}}q.data=k;q.width=h;q.height=f;var n={};if(i&&typeof i===aD){for(var p in i){n[p]=i[p]}}if(b&&typeof b===aD){for(var l in b){if(typeof n.flashvars!=aq){n.flashvars+="&"+l+"="+b[l]}else{n.flashvars=l+"="+b[l]}}}if(ao(c)){var m=aA(q,n,e);if(q.id==e){ay(e,true)}d.success=true;d.ref=m}else{if(a&&au()){q.data=a;ae(q,n,e,j);return}else{ay(e,true)}}if(j){j(d)}})}else{if(j){j(d)}}},switchOffAutoHideShow:function(){aI=false},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}},hasFlashPlayerVersion:ao,createSWF:function(a,b,c){if(ah.w3){return aA(a,b,c)}else{return undefined}},showExpressInstall:function(b,a,d,c){if(ah.w3&&au()){ae(b,a,d,c)}},removeSWF:function(a){if(ah.w3){aw(a)}},createCSS:function(b,a,c,d){if(ah.w3){az(b,a,c,d)}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(b){var a=aL.location.search||aL.location.hash;if(a){if(/\?/.test(a)){a=a.split("?")[1]}if(b==null){return ai(a)}var c=a.split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==b){return ai(c[d].substring((c[d].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aU){var a=aS(ac);if(a&&aJ){a.parentNode.replaceChild(aJ,a);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block"}}if(ap){ap(at)}}aU=false}}}}();function FABridge(b,a){this.target=b;this.remoteTypeCache={};this.remoteInstanceCache={};this.remoteFunctionCache={};this.localFunctionCache={};this.bridgeID=FABridge.nextBridgeID++;this.name=a;this.nextLocalFuncID=0;FABridge.instances[this.name]=this;FABridge.idMap[this.bridgeID]=this;return this}FABridge.TYPE_ASINSTANCE=1;FABridge.TYPE_ASFUNCTION=2;FABridge.TYPE_JSFUNCTION=3;FABridge.TYPE_ANONYMOUS=4;FABridge.initCallbacks={};FABridge.userTypes={};FABridge.addToUserTypes=function(){for(var a=0;a<arguments.length;a++){FABridge.userTypes[arguments[a]]={typeName:arguments[a],enriched:false}}};FABridge.argsToArray=function(b){var a=[];for(var c=0;c<b.length;c++){a[c]=b[c]}return a};function instanceFactory(a){this.fb_instance_id=a;return this}function FABridge__invokeJSFunction(a){var c=a[0];var b=a.concat();b.shift();var d=FABridge.extractBridgeFromID(c);return d.invokeLocalFunction(c,b)}FABridge.addInitializationCallback=function(b,d){var c=FABridge.instances[b];if(c!=undefined){d.call(c);return}var a=FABridge.initCallbacks[b];if(a==null){FABridge.initCallbacks[b]=a=[]}a.push(d)};function FABridge__bridgeInitialized(g){var a=document.getElementsByTagName("object");var f=a.length;var d=[];if(f>0){for(var u=0;u<f;u++){if(typeof a[u].SetVariable!="undefined"){d[d.length]=a[u]}}}var n=document.getElementsByTagName("embed");var b=n.length;var t=[];if(b>0){for(var r=0;r<b;r++){if(typeof n[r].SetVariable!="undefined"){t[t.length]=n[r]}}}var c=d.length;var s=t.length;var h="bridgeName="+g;if((c==1&&!s)||(c==1&&s==1)){FABridge.attachBridge(d[0],g)}else{if(s==1&&!c){FABridge.attachBridge(t[0],g)}else{var v=false;if(c>1){for(var q=0;q<c;q++){var x=d[q].childNodes;for(var p=0;p<x.length;p++){var e=x[p];if(e.nodeType==1&&e.tagName.toLowerCase()=="param"&&e.name.toLowerCase()=="flashvars"&&e.value.indexOf(h)>=0){FABridge.attachBridge(d[q],g);v=true;break}}if(v){break}}}if(!v&&s>1){for(var o=0;o<s;o++){var w=t[o].attributes.getNamedItem("flashVars").nodeValue;if(w.indexOf(h)>=0){FABridge.attachBridge(t[o],g);break}}}}}return true}FABridge.nextBridgeID=0;FABridge.instances={};FABridge.idMap={};FABridge.refCount=0;FABridge.extractBridgeFromID=function(b){var a=(b>>16);return FABridge.idMap[a]};FABridge.attachBridge=function(a,c){var b=new FABridge(a,c);FABridge[c]=b;var e=FABridge.initCallbacks[c];if(e==null){return}for(var d=0;d<e.length;d++){e[d].call(b)}delete FABridge.initCallbacks[c]};FABridge.blockedMethods={toString:true,get:true,set:true,call:true};FABridge.prototype={root:function(){return this.deserialize(this.target.getRoot())},releaseASObjects:function(){return this.target.releaseASObjects()},releaseNamedASObject:function(b){if(typeof(b)!="object"){return false}else{var a=this.target.releaseNamedASObject(b.fb_instance_id);return a}},create:function(a){return this.deserialize(this.target.create(a))},makeID:function(a){return(this.bridgeID<<16)+a},getPropertyFromAS:function(b,a){if(FABridge.refCount>0){throw new Error("You are trying to call recursively into the Flash Player which is not allowed. In most cases the JavaScript setTimeout function, can be used as a workaround.")}else{FABridge.refCount++;retVal=this.target.getPropFromAS(b,a);retVal=this.handleError(retVal);FABridge.refCount--;return retVal}},setPropertyInAS:function(c,b,a){if(FABridge.refCount>0){throw new Error("You are trying to call recursively into the Flash Player which is not allowed. In most cases the JavaScript setTimeout function, can be used as a workaround.")}else{FABridge.refCount++;retVal=this.target.setPropInAS(c,b,this.serialize(a));retVal=this.handleError(retVal);FABridge.refCount--;return retVal}},callASFunction:function(b,a){if(FABridge.refCount>0){throw new Error("You are trying to call recursively into the Flash Player which is not allowed. In most cases the JavaScript setTimeout function, can be used as a workaround.")}else{FABridge.refCount++;retVal=this.target.invokeASFunction(b,this.serialize(a));retVal=this.handleError(retVal);FABridge.refCount--;return retVal}},callASMethod:function(b,c,a){if(FABridge.refCount>0){throw new Error("You are trying to call recursively into the Flash Player which is not allowed. In most cases the JavaScript setTimeout function, can be used as a workaround.")}else{FABridge.refCount++;a=this.serialize(a);retVal=this.target.invokeASMethod(b,c,a);retVal=this.handleError(retVal);FABridge.refCount--;return retVal}},invokeLocalFunction:function(d,b){var a;var c=this.localFunctionCache[d];if(c!=undefined){a=this.serialize(c.apply(null,this.deserialize(b)))}return a},getTypeFromName:function(a){return this.remoteTypeCache[a]},createProxy:function(c,b){var d=this.getTypeFromName(b);instanceFactory.prototype=d;var a=new instanceFactory(c);this.remoteInstanceCache[c]=a;return a},getProxy:function(a){return this.remoteInstanceCache[a]},addTypeDataToCache:function(e){var c=new ASProxy(this,e.name);var b=e.accessors;for(var d=0;d<b.length;d++){this.addPropertyToType(c,b[d])}var a=e.methods;for(var d=0;d<a.length;d++){if(FABridge.blockedMethods[a[d]]==undefined){this.addMethodToType(c,a[d])}}this.remoteTypeCache[c.typeName]=c;return c},addPropertyToType:function(a,e){var f=e.charAt(0);var b;var d;if(f>="a"&&f<="z"){d="get"+f.toUpperCase()+e.substr(1);b="set"+f.toUpperCase()+e.substr(1)}else{d="get"+e;b="set"+e}a[b]=function(c){this.bridge.setPropertyInAS(this.fb_instance_id,e,c)};a[d]=function(){return this.bridge.deserialize(this.bridge.getPropertyFromAS(this.fb_instance_id,e))}},addMethodToType:function(a,b){a[b]=function(){return this.bridge.deserialize(this.bridge.callASMethod(this.fb_instance_id,b,FABridge.argsToArray(arguments)))}},getFunctionProxy:function(a){var b=this;if(this.remoteFunctionCache[a]==null){this.remoteFunctionCache[a]=function(){b.callASFunction(a,FABridge.argsToArray(arguments))}}return this.remoteFunctionCache[a]},getFunctionID:function(a){if(a.__bridge_id__==undefined){a.__bridge_id__=this.makeID(this.nextLocalFuncID++);this.localFunctionCache[a.__bridge_id__]=a}return a.__bridge_id__},serialize:function(d){var a={};var c=typeof(d);if(c=="number"||c=="string"||c=="boolean"||c==null||c==undefined){a=d}else{if(d instanceof Array){a=[];for(var b=0;b<d.length;b++){a[b]=this.serialize(d[b])}}else{if(c=="function"){a.type=FABridge.TYPE_JSFUNCTION;a.value=this.getFunctionID(d)}else{if(d instanceof ASProxy){a.type=FABridge.TYPE_ASINSTANCE;a.value=d.fb_instance_id}else{a.type=FABridge.TYPE_ANONYMOUS;a.value=d}}}}return a},deserialize:function(e){var a;var c=typeof(e);if(c=="number"||c=="string"||c=="boolean"||e==null||e==undefined){a=this.handleError(e)}else{if(e instanceof Array){a=[];for(var b=0;b<e.length;b++){a[b]=this.deserialize(e[b])}}else{if(c=="object"){for(var b=0;b<e.newTypes.length;b++){this.addTypeDataToCache(e.newTypes[b])}for(var d in e.newRefs){this.createProxy(d,e.newRefs[d])}if(e.type==FABridge.TYPE_PRIMITIVE){a=e.value}else{if(e.type==FABridge.TYPE_ASFUNCTION){a=this.getFunctionProxy(e.value)}else{if(e.type==FABridge.TYPE_ASINSTANCE){a=this.getProxy(e.value)}else{if(e.type==FABridge.TYPE_ANONYMOUS){a=e.value}}}}}}}return a},addRef:function(a){this.target.incRef(a.fb_instance_id)},release:function(a){this.target.releaseRef(a.fb_instance_id)},handleError:function(b){if(typeof(b)=="string"&&b.indexOf("__FLASHERROR")==0){var a=b.split("||");if(FABridge.refCount>0){FABridge.refCount--}throw new Error(a[1]);return b}else{return b}}};ASProxy=function(b,a){this.bridge=b;this.typeName=a;return this};ASProxy.prototype={get:function(a){return this.bridge.deserialize(this.bridge.getPropertyFromAS(this.fb_instance_id,a))},set:function(b,a){this.bridge.setPropertyInAS(this.fb_instance_id,b,a)},call:function(b,a){this.bridge.callASMethod(this.fb_instance_id,b,a)},addRef:function(){this.bridge.addRef(this)},release:function(){this.bridge.release(this)}};(function(){if(window.WebSocket){return}var a=window.console;if(!a){a={log:function(){},error:function(){}}}if(!swfobject.hasFlashPlayerVersion("9.0.0")){a.error("Flash Player is not installed.");return}if(location.protocol=="file:"){a.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://...")}WebSocket=function(e,h,d,g,f){var c=this;c.readyState=WebSocket.CONNECTING;c.bufferedAmount=0;setTimeout(function(){WebSocket.__addTask(function(){c.__createFlash(e,h,d,g,f)})},1)};WebSocket.prototype.__createFlash=function(e,h,d,g,f){var c=this;c.__flash=WebSocket.__flash.create(e,h,d||null,g||0,f||null);c.__flash.addEventListener("open",function(i){try{c.readyState=c.__flash.getReadyState();if(c.__timer){clearInterval(c.__timer)}if(window.opera){c.__timer=setInterval(function(){c.__handleMessages()},500)}if(c.onopen){c.onopen()}}catch(j){a.error(j.toString())}});c.__flash.addEventListener("close",function(i){try{c.readyState=c.__flash.getReadyState();if(c.__timer){clearInterval(c.__timer)}if(c.onclose){c.onclose()}}catch(j){a.error(j.toString())}});c.__flash.addEventListener("message",function(){try{c.__handleMessages()}catch(i){a.error(i.toString())}});c.__flash.addEventListener("error",function(i){try{if(c.__timer){clearInterval(c.__timer)}if(c.onerror){c.onerror()}}catch(j){a.error(j.toString())}});c.__flash.addEventListener("stateChange",function(i){try{c.readyState=c.__flash.getReadyState();c.bufferedAmount=i.getBufferedAmount()}catch(j){a.error(j.toString())}})};WebSocket.prototype.send=function(d){if(this.__flash){this.readyState=this.__flash.getReadyState()}if(!this.__flash||this.readyState==WebSocket.CONNECTING){throw"INVALID_STATE_ERR: Web Socket connection has not been established"}var c=this.__flash.send(encodeURIComponent(d));if(c<0){return true}else{this.bufferedAmount=c;return false}};WebSocket.prototype.close=function(){var c=this;if(!c.__flash){return}c.readyState=c.__flash.getReadyState();if(c.readyState==WebSocket.CLOSED||c.readyState==WebSocket.CLOSING){return}c.__flash.close();c.readyState=WebSocket.CLOSED;if(c.__timer){clearInterval(c.__timer)}if(c.onclose){setTimeout(c.onclose,1)}};WebSocket.prototype.addEventListener=function(d,e,c){if(!("__events" in this)){this.__events={}}if(!(d in this.__events)){this.__events[d]=[];if("function"==typeof this["on"+d]){this.__events[d].defaultHandler=this["on"+d];this["on"+d]=this.__createEventHandler(this,d)}}this.__events[d].push(e)};WebSocket.prototype.removeEventListener=function(e,f,c){if(!("__events" in this)){this.__events={}}if(!(e in this.__events)){return}for(var d=this.__events.length;d>-1;--d){if(f===this.__events[e][d]){this.__events[e].splice(d,1);break}}};WebSocket.prototype.dispatchEvent=function(e){if(!("__events" in this)){throw"UNSPECIFIED_EVENT_TYPE_ERR"}if(!(e.type in this.__events)){throw"UNSPECIFIED_EVENT_TYPE_ERR"}for(var d=0,c=this.__events[e.type].length;d<c;++d){this.__events[e.type][d](e);if(e.cancelBubble){break}}if(false!==e.returnValue&&"function"==typeof this.__events[e.type].defaultHandler){this.__events[e.type].defaultHandler(e)}};WebSocket.prototype.__handleMessages=function(){var c=this.__flash.readSocketData();for(var d=0;d<c.length;d++){var f=decodeURIComponent(c[d]);try{if(this.onmessage){var g;if(window.MessageEvent&&!window.opera){g=document.createEvent("MessageEvent");g.initMessageEvent("message",false,false,f,null,null,window,null)}else{g={data:f}}this.onmessage(g)}}catch(g){a.error(g.toString())}}};WebSocket.prototype.__createEventHandler=function(c,d){return function(g){var f=new b();f.initEvent(d,true,true);f.target=f.currentTarget=c;for(var e in g){f[e]=g[e]}c.dispatchEvent(f,arguments)}};function b(){}b.prototype.cancelable=true;b.prototype.cancelBubble=false;b.prototype.preventDefault=function(){if(this.cancelable){this.returnValue=false}};b.prototype.stopPropagation=function(){this.cancelBubble=true};b.prototype.initEvent=function(c,e,d){this.type=c;this.cancelable=d;this.timeStamp=new Date()};WebSocket.CONNECTING=0;WebSocket.OPEN=1;WebSocket.CLOSING=2;WebSocket.CLOSED=3;WebSocket.__tasks=[];WebSocket.__initialize=function(){if(WebSocket.__swfLocation){window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation}if(!window.WEB_SOCKET_SWF_LOCATION){a.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");return}var c=document.createElement("div");c.id="webSocketContainer";c.style.position="absolute";if(WebSocket.__isFlashLite()){c.style.left="0px";c.style.top="0px"}else{c.style.left="-100px";c.style.top="-100px"}var d=document.createElement("div");d.id="webSocketFlash";c.appendChild(d);document.body.appendChild(c);swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","9.0.0",null,{bridgeName:"webSocket"},{hasPriority:true,allowScriptAccess:"always"},null,function(f){if(!f.success){a.error("[WebSocket] swfobject.embedSWF failed")}});FABridge.addInitializationCallback("webSocket",function(){try{WebSocket.__flash=FABridge.webSocket.root();WebSocket.__flash.setCallerUrl(location.href);WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var f=0;f<WebSocket.__tasks.length;++f){WebSocket.__tasks[f]()}WebSocket.__tasks=[]}catch(g){a.error("[WebSocket] "+g.toString())}})};WebSocket.__addTask=function(c){if(WebSocket.__flash){c()}else{WebSocket.__tasks.push(c)}};WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes){return false}var c=window.navigator.mimeTypes["application/x-shockwave-flash"];if(!c||!c.enabledPlugin||!c.enabledPlugin.filename){return false}return c.enabledPlugin.filename.match(/flashlite/i)?true:false};window.webSocketLog=function(c){a.log(decodeURIComponent(c))};window.webSocketError=function(c){a.error(decodeURIComponent(c))};if(!window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION){if(window.addEventListener){window.addEventListener("load",WebSocket.__initialize,false)}else{window.attachEvent("onload",WebSocket.__initialize)}}})();var Rocket=function(b,c){this.socketId;this.url=b+"/app/"+c;this.appID=c;this.channels=new Rocket.Channels();this.retryCounter=0;this.isConnected=false;this.globalChannel=new Rocket.Channel();this.globalChannel.isGlobal=true;this.connect();var a=this;this.globalChannel.bind("rocket:connected",function(d){a.isConnected=true;a.retryCounter=0;a.socketId=d.socket_id;a.subscribeAll()});this.globalChannel.bind("rocket:error",function(d){})};Rocket.prototype={connect:function(){Rocket.log("Rocket : connecting with "+this.url);this.allowReconnect=true;var a=this;if(window.WebSocket){this.connection=new WebSocket(this.url);this.connection.onmessage=function(b){a.onmessage(b)};this.connection.onclose=function(){a.onclose()};this.connection.onopen=function(){a.onopen()}}else{Rocket.log("Rocket : can't establish connection");this.connection={};this.onclose()}return this},disconnect:function(){Rocket.log("Rocket : disconnecting");this.allowReconnect=false;this.isConnected=false;this.retryCount=0;this.connection.close();return this},reconnect:function(b){var a=this;setTimeout(function(){a.connect()},b);return this},channel:function(a){return this.channels.find(a)},trigger:function(a,b){if(this.isConnected){var c=JSON.stringify({event:a,data:b});Rocket.log("Rocket : triggering event : "+c);this.connection.send(c)}else{Rocket.log("Rocket : not connected : can't trigger event "+a)}return this},subscribe:function(a){var b=this.channels.add(a);this.trigger("rocket:subscribe",{channel:a});return b},unsubscribe:function(a){this.channels.remove(a);this.trigger("rocket:unsubscribe",{channel:a});return this},subscribeAll:function(){for(var a in this.channels.all){if(this.channels.all.hasOwnProperty(a)){this.subscribe(a)}}},onclose:function(){Rocket.log("Rocket : socket closed");this.globalChannel.dispatch("rocket:close",null);var a=Rocket.reconnectDelay;if(!(this.isConnected)){this.globalChannel.dispatch("rocket:disconnected",{});if(Rocket.allowReconnect){Rocket.log("Pusher : reconnecting in 5 seconds...");this.reconnect(a)}}else{this.globalChannel("rocket:connection_failed",{});if(this.retryCounter==0){a=100}this.retryCounter=this.retryCounter+1;this.reconnect(a)}this.connected=false},onopen:function(){this.globalChannel.dispatch("rocket:open",null)},onmessage:function(c){Rocket.log("Rocket : received message : "+c.data);var b=JSON.parse(c.data);var a=b.channel?this.channel(b.channel):this.globalChannel;a.dispatch(b.event,b.data)},};Rocket.Channels=function(){this.all={}};Rocket.Channels.prototype={add:function(a){existingChannel=this.find(a);if(!existingChannel){return(this.all[a]=new Rocket.Channel())}else{return existingChannel}},find:function(a){return this.all[a]},remove:function(a){delete this.all[a]}};Rocket.Channel=function(){this.callbacks={};this.globalCallbacks=[]};Rocket.Channel.prototype={bind:function(a,b){this.callbacks[a]=this.callbacks[a]||[];this.callbacks[a].push(b);return this},bindAll:function(a){this.globalCallbacks.push(a);return this},dispatch:function(a,d){var c=this.callbacks[a];if(c){Rocket.log("Rocket : Executing callbacks for "+a);for(var b=0;b<c.length;b++){c[b](d)}}else{if(!this.isGlobal){Rocket.log("Rocket : No callbacks for "+a)}}for(var b=0;b<this.globalCallbacks.length;b++){this.globalCallbacks[b](a,d)}}};var WEB_SOCKET_SWF_LOCATION="WebSocketMain.swf";var WEB_SOCKET_DEBUG=false;Rocket.reconnectDelay=5000;Rocket.allowReconnect=true;Rocket.log=function(a){};Rocket.parser=function(a){try{return JSON.parse(a)}catch(b){Pusher.log("Rocket : data attribute not valid JSON - you may wish to implement your own Rocket.parser");return a}};